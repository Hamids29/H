SELECT 
    COUNT(*) as total_patients,
    COUNT(CASE WHEN shipdate IS NOT NULL THEN 1 END) as patients_with_shipment,
    COUNT(CASE WHEN shipdate IS NULL THEN 1 END) as patients_without_shipment
FROM cdp.prometrics_sp_data_pull
WHERE refdate >= '2025-02-01'
    AND refdate <= '2025-04-30';
